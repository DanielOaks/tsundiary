{% extends "base.html" %}

{% block content %}

<div style="text-align: center; margin: 0 auto;">
    <p id='login_status'>&nbsp;</p>
    <div id='login_box' class='cloud'>
        <input id='username' type='text' placeholder="username" class='first' /><br />
        <input id='password' type='password' placeholder="password" class='last' /><br />
        <hr />
        <input id='submitbutton' type='submit' value='enter' style='padding-top: 10px; padding-bottom: 10px' />
    </div>
    <div style='height: 20px'></div>
</div>

<script>

var wait_messages = ['Wait one sec...', "I'll just make sure...", 'Stay right there...', 'Chotto matte...'];

function attempt_login() {
    var username = $('#username').val();
    var password = $('#password').val();

    if (username && password) {
        $('#submitbutton').addClass('active');
        $.post('attempt_login', { username: username, password: password },
            function(data) {
                $('#login_status').html(data);
                if (data.substr(0, 18) == 'Oh... welcome back') {
                    setTimeout(function() { document.location.reload(true); }, 500);
                }
                else {
                    $('#submitbutton').removeClass('active');
                }
            });

        var rand = Math.floor(Math.random()*wait_messages.length);
        $('#login_status').html(wait_messages[rand]);
    }
}

function check_key(e) {
    if (e.keyCode == 13) {
        attempt_login();
    }
}

$('#username').keyup(check_key);
$('#password').keyup(check_key);
$('#submitbutton').click(attempt_login);

</script>

{% endblock %}

